<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="Calculate and track your CGPA offline. Set goals, view progress, and share results.">
    <title>CGPA Calculator Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 30px;
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #667eea;
            margin-bottom: 5px;
            font-size: 2em;
        }

        .subtitle {
            color: #666;
            font-size: 0.9em;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            overflow-x: auto;
        }

        .tab {
            background: none;
            border: none;
            padding: 12px 15px;
            cursor: pointer;
            font-size: 0.9em;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .semester-select {
            margin-bottom: 20px;
        }

        .semester-select input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 10px;
        }

        .course-list {
            margin-bottom: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .course-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .course-number {
            background: #667eea;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .course-inputs {
            display: flex;
            gap: 10px;
            flex: 1;
            flex-wrap: wrap;
        }

        .input-group {
            flex: 1;
            min-width: 120px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-size: 0.85em;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .remove-btn {
            background: #ff4757;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .btn {
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            width: 100%;
            margin-bottom: 10px;
            transition: opacity 0.3s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-primary { background: #667eea; }
        .btn-success { background: #2ecc71; }
        .btn-danger { background: #e74c3c; }
        .btn-warning { background: #f39c12; }
        .btn-info { background: #3498db; }

        .result {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
        }

        .result h2 {
            font-size: 1.2em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .cgpa-value {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            margin: 5px;
        }

        .stat-label {
            font-size: 0.85em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
        }

        .saved-semesters {
            margin-top: 20px;
        }

        .semester-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .semester-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .semester-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        .semester-gpa {
            font-size: 1.5em;
            font-weight: bold;
            color: #2ecc71;
        }

        .semester-stats {
            display: flex;
            gap: 20px;
            font-size: 0.9em;
            color: #666;
            flex-wrap: wrap;
        }

        .delete-semester {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 4em;
            margin-bottom: 10px;
        }

        .chart-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            height: 200px;
            gap: 10px;
            margin-top: 40px;
            margin-bottom: 30px;
        }

        .bar {
            flex: 1;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 5px 5px 0 0;
            position: relative;
            min-height: 20px;
            transition: all 0.3s;
        }

        .bar:hover {
            opacity: 0.8;
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            white-space: nowrap;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: bold;
            font-size: 0.9em;
            color: #667eea;
        }

        .goal-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .goal-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .goal-result {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .achievement {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .achievement-icon {
            font-size: 2em;
        }

        .achievement.locked {
            background: #e0e0e0;
            color: #999;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
            color: #666;
            font-size: 0.9em;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #2ecc71;
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1000;
        }

        .toast.show {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 1.5em;
            }
            .course-inputs {
                flex-direction: column;
            }
            .tabs {
                overflow-x: auto;
            }
            .goal-input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎓 CGPA Calculator Pro</h1>
            <p class="subtitle">Track, Analyze & Achieve Your Academic Goals</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('calculator')">📊 Calculator</button>
            <button class="tab" onclick="switchTab('history')">📚 Semesters</button>
            <button class="tab" onclick="switchTab('analytics')">📈 Analytics</button>
            <button class="tab" onclick="switchTab('goals')">🎯 Goals</button>
            <button class="tab" onclick="switchTab('achievements')">🏆 Achievements</button>
            <button class="tab" onclick="switchTab('share')">📤 Share</button>
        </div>

        <!-- Calculator Tab -->
        <div id="calculatorTab" class="tab-content active">
            <div class="semester-select">
                <label>Semester Name</label>
                <input type="text" id="semesterName" placeholder="e.g., Semester 1 - Year 1">
            </div>

            <div class="course-list" id="courseList"></div>

            <button class="btn btn-primary" onclick="addCourse()">+ Add Course</button>
            <button class="btn btn-success" onclick="saveSemester()">💾 Save Semester</button>

            <div class="result">
                <h2>Current CGPA</h2>
                <div class="cgpa-value" id="cgpaValue">0.00</div>
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-label">Courses</div>
                        <div class="stat-value" id="totalCourses">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total CUs</div>
                        <div class="stat-value" id="totalCUs">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- History Tab -->
        <div id="historyTab" class="tab-content">
            <div id="savedSemesters" class="saved-semesters"></div>
            
            <div class="result" style="margin-top: 20px;">
                <h2>Cumulative CGPA</h2>
                <div class="cgpa-value" id="overallCGPA">0.00</div>
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-label">Semesters</div>
                        <div class="stat-value" id="totalSemesters">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total CUs</div>
                        <div class="stat-value" id="overallCUs">0</div>
                    </div>
                </div>
            </div>
            <button class="btn btn-danger" onclick="clearAllData()">🗑️ Clear All Data</button>
        </div>

        <!-- Analytics Tab -->
        <div id="analyticsTab" class="tab-content">
            <h3 style="color: #667eea; margin-bottom: 15px;">📈 Performance Overview</h3>
            <div class="chart-container">
                <h4>Semester-wise CGPA Progression</h4>
                <div class="bar-chart" id="barChart"></div>
            </div>
            
            <div class="chart-container">
                <h4>Statistics</h4>
                <div class="stats" style="border: none; padding: 0; margin-top: 15px;">
                    <div class="stat-item">
                        <div class="stat-label">Highest CGPA</div>
                        <div class="stat-value" style="color: #2ecc71;" id="highestCGPA">0.00</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Lowest CGPA</div>
                        <div class="stat-value" style="color: #e74c3c;" id="lowestCGPA">0.00</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Average CGPA</div>
                        <div class="stat-value" style="color: #667eea;" id="averageCGPA">0.00</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Goals Tab -->
        <div id="goalsTab" class="tab-content">
            <div class="goal-section">
                <h3 style="color: #667eea; margin-bottom: 15px;">🎯 Target CGPA Calculator</h3>
                <p style="margin-bottom: 15px; color: #666;">Calculate what CGPA you need in upcoming semesters to reach your goal</p>
                
                <div class="goal-input-group">
                    <div style="flex: 1;">
                        <label>Target CGPA</label>
                        <input type="number" id="targetCGPA" min="0" max="5" step="0.1" placeholder="e.g., 4.5">
                    </div>
                    <div style="flex: 1;">
                        <label>Remaining Credit Units</label>
                        <input type="number" id="remainingCUs" min="1" placeholder="e.g., 30">
                    </div>
                </div>
                
                <button class="btn btn-info" onclick="calculateGoal()">Calculate Required CGPA</button>
                
                <div class="goal-result" id="goalResult" style="display: none;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Result:</h4>
                    <p id="goalResultText"></p>
                </div>
            </div>
        </div>

        <!-- Achievements Tab -->
        <div id="achievementsTab" class="tab-content">
            <h3 style="color: #667eea; margin-bottom: 15px;">🏆 Your Achievements</h3>
            <div id="achievementsList"></div>
        </div>

        <!-- Share Tab -->
        <div id="shareTab" class="tab-content">
            <h3 style="color: #667eea; margin-bottom: 15px;">📤 Share Your Results</h3>
            
            <button class="btn btn-primary" onclick="shareResults()">📱 Share via Apps</button>
            <button class="btn btn-warning" onclick="exportToPDF()">📄 Export to PDF</button>
            
            <div class="chart-container" style="margin-top: 20px;">
                <h4>Quick Stats for Sharing</h4>
                <div id="shareStats"></div>
            </div>
        </div>

        <div class="footer">
            <p><strong>CGPA Calculator Pro</strong></p>
            <p style="margin: 10px 0;">Developed with ❤️ for students</p>
            <p style="font-size: 0.85em;">© 2025 Sempijja Pius. All Rights Reserved</p>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        let courseCount = 0;
        let courses = {};

        // Initialize app
        window.onload = function() {
            addCourse();
            addCourse();
            addCourse();
            displaySavedSemesters();
        };

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
            
            if (tab === 'history') displaySavedSemesters();
            if (tab === 'analytics') displayAnalytics();
            if (tab === 'achievements') displayAchievements();
            if (tab === 'share') updateShareStats();
        }

        function addCourse() {
            courseCount++;
            const courseList = document.getElementById('courseList');
            
            const courseItem = document.createElement('div');
            courseItem.className = 'course-item';
            courseItem.id = `course-${courseCount}`;
            
            courseItem.innerHTML = `
                <div class="course-number">${courseCount}</div>
                <div class="course-inputs">
                    <div class="input-group">
                        <label>Course Name</label>
                        <input type="text" id="name-${courseCount}" placeholder="e.g., Mathematics">
                    </div>
                    <div class="input-group">
                        <label>Grade Point (0-5)</label>
                        <input type="number" id="gp-${courseCount}" min="0" max="5" step="0.1" placeholder="4.5" onchange="calculateCGPA()">
                    </div>
                    <div class="input-group">
                        <label>Credit Units</label>
                        <select id="cu-${courseCount}" onchange="calculateCGPA()">
                            <option value="">Select</option>
                            <option value="2">2 CUs</option>
                            <option value="3">3 CUs</option>
                            <option value="4">4 CUs</option>
                            <option value="5">5 CUs</option>
                        </select>
                    </div>
                </div>
                <button class="remove-btn" onclick="removeCourse(${courseCount})">×</button>
            `;
            
            courseList.appendChild(courseItem);
            courses[courseCount] = { name: '', gp: 0, cu: 0 };
        }

        function removeCourse(id) {
            const courseItem = document.getElementById(`course-${id}`);
            if (courseItem) {
                courseItem.remove();
                delete courses[id];
                calculateCGPA();
            }
        }

        function calculateCGPA() {
            let totalPoints = 0;
            let totalCUs = 0;
            let validCourses = 0;

            for (let id in courses) {
                const nameInput = document.getElementById(`name-${id}`);
                const gpInput = document.getElementById(`gp-${id}`);
                const cuSelect = document.getElementById(`cu-${id}`);
                
                if (gpInput && cuSelect && gpInput.value && cuSelect.value) {
                    const gp = parseFloat(gpInput.value);
                    const cu = parseInt(cuSelect.value);
                    
                    if (!isNaN(gp) && !isNaN(cu) && gp >= 0 && gp <= 5) {
                        totalPoints += gp * cu;
                        totalCUs += cu;
                        validCourses++;
                        
                        if (nameInput) {
                            courses[id] = { name: nameInput.value, gp: gp, cu: cu };
                        }
                    }
                }
            }

            const cgpa = totalCUs > 0 ? (totalPoints / totalCUs).toFixed(2) : 0;
            document.getElementById('cgpaValue').textContent = cgpa;
            document.getElementById('totalCourses').textContent = validCourses;
            document.getElementById('totalCUs').textContent = totalCUs;
        }

        function saveSemester() {
            const semesterName = document.getElementById('semesterName').value || `Semester ${Date.now()}`;
            
            calculateCGPA();
            
            const cgpa = parseFloat(document.getElementById('cgpaValue').textContent);
            const totalCUs = parseInt(document.getElementById('totalCUs').textContent);
            
            if (totalCUs === 0) {
                showToast('Please add at least one course with valid data!', 'error');
                return;
            }

            const coursesData = [];
            for (let id in courses) {
                if (courses[id].cu > 0) {
                    coursesData.push(courses[id]);
                }
            }

            const semester = {
                name: semesterName,
                cgpa: cgpa,
                totalCUs: totalCUs,
                courses: coursesData,
                date: new Date().toLocaleDateString()
            };

            let semesters = JSON.parse(getData('semesters') || '[]');
            semesters.push(semester);
            saveData('semesters', JSON.stringify(semesters));

            showToast('Semester saved successfully! 🎉');
            
            document.getElementById('semesterName').value = '';
            document.getElementById('courseList').innerHTML = '';
            courseCount = 0;
            courses = {};
            addCourse();
            addCourse();
            addCourse();
            calculateCGPA();
        }

        function displaySavedSemesters() {
            const container = document.getElementById('savedSemesters');
            const semesters = JSON.parse(getData('semesters') || '[]');

            if (semesters.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">📚</div>
                        <p>No saved semesters yet</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">Go to Calculator tab to add your first semester</p>
                    </div>
                `;
                document.getElementById('overallCGPA').textContent = '0.00';
                document.getElementById('totalSemesters').textContent = '0';
                document.getElementById('overallCUs').textContent = '0';
                return;
            }

            let totalPoints = 0;
            let totalCUs = 0;

            container.innerHTML = '';
            semesters.forEach((sem, index) => {
                totalPoints += sem.cgpa * sem.totalCUs;
                totalCUs += sem.totalCUs;

                const card = document.createElement('div');
                card.className = 'semester-card';
                card.innerHTML = `
                    <div class="semester-header">
                        <div>
                            <div class="semester-title">${sem.name}</div>
                            <div style="font-size: 0.9em; color: #999; margin-top: 5px;">${sem.date}</div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div class="semester-gpa">${sem.cgpa}</div>
                            <button class="delete-semester" onclick="deleteSemester(${index})">×</button>
                        </div>
                    </div>
                    <div class="semester-stats">
                        <span>📚 ${sem.courses.length} courses</span>
                        <span>📊 ${sem.totalCUs} CUs</span>
                    </div>
                `;
                container.appendChild(card);
            });

            const overallCGPA = totalCUs > 0 ? (totalPoints / totalCUs).toFixed(2) : 0;
            document.getElementById('overallCGPA').textContent = overallCGPA;
            document.getElementById('totalSemesters').textContent = semesters.length;
            document.getElementById('overallCUs').textContent = totalCUs;
        }

        function deleteSemester(index) {
            if (confirm('Are you sure you want to delete this semester?')) {
                let semesters = JSON.parse(getData('semesters') || '[]');
                semesters.splice(index, 1);
                saveData('semesters', JSON.stringify(semesters));
                displaySavedSemesters();
                showToast('Semester deleted');
            }
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear ALL data? This cannot be undone!')) {
                saveData('semesters', '[]');
                displaySavedSemesters();
                showToast('All data cleared');
            }
        }

        function displayAnalytics() {
            const semesters = JSON.parse(getData('semesters') || '[]');
            const barChart = document.getElementById('barChart');

            if (semesters.length === 0) {
                barChart.innerHTML = '<div class="empty-state"><p>No data to display</p></div>';
                document.getElementById('highestCGPA').textContent = '0.00';
                document.getElementById('lowestCGPA').textContent = '0.00';
                document.getElementById('averageCGPA').textContent = '0.00';
                return;
            }

            const cgpas = semesters.map(s => s.cgpa);
            const maxCGPA = Math.max(...cgpas);
            const minCGPA = Math.min(...cgpas);
            const avgCGPA = (cgpas.reduce((a, b) => a + b, 0) / cgpas.length).toFixed(2);

            barChart.innerHTML = '';
            semesters.forEach((sem, idx) => {
                const height = (sem.cgpa / 5) * 100;
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = height + '%';
                bar.innerHTML = `
                    <div class="bar-value">${sem.cgpa}</div>
                    <div class="bar-label">S${idx + 1}</div>
                `;
                barChart.appendChild(bar);
            });

            document.getElementById('highestCGPA').textContent = maxCGPA.toFixed(2);
            document.getElementById('lowestCGPA').textContent = minCGPA.toFixed(2);
            document.getElementById('averageCGPA').textContent = avgCGPA;
        }

        function calculateGoal() {
            const target = parseFloat(document.getElementById('targetCGPA').value);
            const remainingCUs = parseInt(document.getElementById('remainingCUs').value);
            const semesters = JSON.parse(getData('semesters') || '[]');

            if (!target || !remainingCUs) {
                showToast('Please fill all fields', 'error');
                return;
            }

            let totalPoints = 0;
            let totalCUs = 0;

            semesters.forEach(sem => {
                totalPoints += sem.cgpa * sem.totalCUs;
                totalCUs += sem.totalCUs;
            });

            const requiredPoints = (target * (totalCUs + remainingCUs)) - totalPoints;
            const requiredCGPA = requiredPoints / remainingCUs;

            const resultDiv = document.getElementById('goalResult');
            const resultText = document.getElementById('goalResultText');

            resultDiv.style.display = 'block';

            if (requiredCGPA > 5) {
                resultText.innerHTML = `❌ Target CGPA of <strong>${target}</strong> is not achievable even with perfect scores (5.0) in remaining courses.`;
            } else if (requiredCGPA < 0) {
                resultText.innerHTML = `✅ Congratulations! You've already achieved your target CGPA of <strong>${target}</strong>!`;
            } else {
                resultText.innerHTML = `
                    📊 To achieve a CGPA of <strong>${target}</strong>, you need to score an average of <strong>${requiredCGPA.toFixed(2)}</strong> in your remaining ${remainingCUs} credit units.<br><br>
                    ${requiredCGPA <= 3.5 ? '✅ This is achievable with consistent effort!' : requiredCGPA <= 4.5 ? '⚠️ This will require strong performance!' : '🔥 This requires excellent performance!'}
                `;
            }
        }

        function displayAchievements() {
            const semesters = JSON.parse(getData('semesters') || '[]');
            const container = document.getElementById('achievementsList');
            
            let totalPoints = 0;
            let totalCUs = 0;
            semesters.forEach(sem => {
                totalPoints += sem.cgpa * sem.totalCUs;
                totalCUs += sem.totalCUs;
            });
            const overallCGPA = totalCUs > 0 ? totalPoints / totalCUs : 0;

            const achievements = [
                { icon: '🎓', title: 'First Semester', desc: 'Complete your first semester', unlocked: semesters.length >= 1 },
                { icon: '📚', title: 'Consistent Student', desc: 'Complete 3 semesters', unlocked: semesters.length >= 3 },
                { icon: '🌟', title: 'High Achiever', desc: 'Maintain CGPA above 4.0', unlocked: overallCGPA >= 4.0 },
                { icon: '💎', title: 'Excellence', desc: 'Maintain CGPA above 4.5', unlocked: overallCGPA >= 4.5 },
                { icon: '🏆', title: 'Perfect Score', desc: 'Achieve 5.0 in any semester', unlocked: semesters.some(s => s.cgpa === 5.0) },
                { icon: '📈', title: 'Improvement', desc: 'Improve CGPA for 2 consecutive semesters', unlocked: checkImprovement(semesters) },
                { icon: '🎯', title: 'Goal Setter', desc: 'Use the goal calculator', unlocked: getData('usedGoals') === 'true' },
                { icon: '💪', title: 'Dedicated', desc: 'Complete 5 semesters', unlocked: semesters.length >= 5 }
            ];

            container.innerHTML = achievements.map(ach => `
                <div class="achievement ${ach.unlocked ? '' : 'locked'}">
                    <div class="achievement-icon">${ach.icon}</div>
                    <div style="flex: 1;">
                        <strong>${ach.title}</strong>
                        <div style="font-size: 0.9em; margin-top: 5px; opacity: 0.9;">${ach.desc}</div>
                    </div>
                    <div style="font-size: 1.5em;">${ach.unlocked ? '✓' : '🔒'}</div>
                </div>
            `).join('');
        }

        function checkImprovement(semesters) {
            if (semesters.length < 3) return false;
            for (let i = 2; i < semesters.length; i++) {
                if (semesters[i].cgpa > semesters[i-1].cgpa && semesters[i-1].cgpa > semesters[i-2].cgpa) {
                    return true;
                }
            }
            return false;
        }

        function updateShareStats() {
            const semesters = JSON.parse(getData('semesters') || '[]');
            const container = document.getElementById('shareStats');

            if (semesters.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999;">No data to share yet</p>';
                return;
            }

            let totalPoints = 0;
            let totalCUs = 0;
            semesters.forEach(sem => {
                totalPoints += sem.cgpa * sem.totalCUs;
                totalCUs += sem.totalCUs;
            });
            const overallCGPA = (totalPoints / totalCUs).toFixed(2);

            container.innerHTML = `
                <div style="padding: 20px; text-align: center;">
                    <div style="font-size: 3em; font-weight: bold; color: #667eea; margin-bottom: 10px;">${overallCGPA}</div>
                    <div style="font-size: 1.2em; margin-bottom: 20px;">Overall CGPA</div>
                    <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px;">
                        <div>
                            <div style="font-size: 1.8em; font-weight: bold; color: #2ecc71;">${semesters.length}</div>
                            <div style="color: #666;">Semesters</div>
                        </div>
                        <div>
                            <div style="font-size: 1.8em; font-weight: bold; color: #3498db;">${totalCUs}</div>
                            <div style="color: #666;">Total CUs</div>
                        </div>
                        <div>
                            <div style="font-size: 1.8em; font-weight: bold; color: #f39c12;">${semesters.reduce((sum, s) => sum + s.courses.length, 0)}</div>
                            <div style="color: #666;">Courses</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function shareResults() {
            const semesters = JSON.parse(getData('semesters') || '[]');
            
            if (semesters.length === 0) {
                showToast('No data to share!', 'error');
                return;
            }

            let totalPoints = 0;
            let totalCUs = 0;
            semesters.forEach(sem => {
                totalPoints += sem.cgpa * sem.totalCUs;
                totalCUs += sem.totalCUs;
            });
            const overallCGPA = (totalPoints / totalCUs).toFixed(2);

            const shareText = `🎓 My Academic Progress\n\nCGPA: ${overallCGPA}\nSemesters: ${semesters.length}\nTotal CUs: ${totalCUs}\n\nCalculated with CGPA Calculator Pro`;

            if (navigator.share) {
                navigator.share({
                    title: 'My CGPA Results',
                    text: shareText
                }).then(() => {
                    showToast('Shared successfully! 🎉');
                }).catch(() => {
                    copyToClipboard(shareText);
                });
            } else {
                copyToClipboard(shareText);
            }
        }

        function exportToPDF() {
            showToast('Opening print dialog...');
            setTimeout(() => {
                window.print();
            }, 500);
        }

        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            showToast('Copied to clipboard! 📋');
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'error' ? '#e74c3c' : '#2ecc71';
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Storage functions using in-memory storage
        const memoryStorage = {};

        function saveData(key, value) {
            memoryStorage[key] = value;
        }

        function getData(key) {
            return memoryStorage[key] || null;
        }
    </script>
</body>
</html>
